# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура

### MVP

- **Model** — управление данными (товары, корзина, заказ, промежуточные данные оформления).
- **View** — визуальные компоненты (каталог, карточка товара, корзина, формы шагов заказа, модальные окна).
- **Presenter** — связывает Model и View, реализует бизнес-логику и обработку событий.

---

## Структура проекта

### Модели (`/models`)

- **CartModel** — управление корзиной пользователя.
- **QuoteModel** — управление промежуточными данными оформления заказа.
- **OrderModel** — создание заказа и взаимодействие с API.
- **ProductModel** — получение и нормализация данных о товарах.
- **Storage** — хранение данных на клиенте (например, корзины).

### Представления (`/components`)

- **ProductGridView** — отображение сетки товаров.
- **ProductPopupView** — модальное окно с подробной информацией о товаре.
- **CartIconView** — иконка корзины с отображением количества товаров.
- **CartStepPopupView** — шаг 1: просмотр корзины.
- **ContactsStepPopupView** — шаг 2: ввод контактных данных.
- **OrderStepPopupView** — шаг 3: выбор способа оплаты и адреса.
- **SuccessStepPopupView** — шаг 4: подтверждение успешного оформления заказа.

### Презентеры (`src/presenters/`)

- **ProductPresenter** — связывает ProductModel и ProductGridView, отображает список товаров.
- **ProductPopupPresenter** — связывает ProductModel и ProductPopupView, отображает подробную информацию о товаре.
- **CartPresenter** — связывает CartModel и CartIconView, обрабатывает добавление/удаление товаров, обновление корзины.
- **CheckoutPresenter** — управляет последовательностью шагов оформления заказа, переключает презентеры шагов.
- **checkout/CartStepPresenter** — обработка шага корзины.
- **checkout/ContactsStepPresenter** — обработка шага ввода контактов.
- **checkout/OrderStepPresenter** — обработка шага выбора оплаты и адреса.
- **checkout/SuccessStepPresenter** — обработка шага успешного заказа.

---

### Типы данных (`/types`)

- **Product** — описание товара.
- **Cart** — структура корзины.
- **Order** — структура заказа.
- **Quote** — промежуточные данные оформления заказа.
- **CheckoutStepPresenter, CheckoutStepValidator** — интерфейсы для шагов оформления заказа.

### API

- **WebLarekApi** — взаимодействие с сервером для получения товаров и создания заказов.

---

## Процесс оформления заказа

Оформление заказа реализовано в виде последовательности шагов:

1. **Корзина** — просмотр и удаление товаров.
2. **Контактная информация** — ввод email и телефона с валидацией.
3. **Доставка и оплата** — ввод адреса и выбор способа оплаты.
4. **Подтверждение** — отображение успешного оформления заказа.

Для каждого шага используется отдельный валидатор:

- **CartValidator**
- **ContactsValidator**
- **OrderValidator**

---

## Система событий

Для коммуникации между компонентами используется singleton `EventEmitter` 
(`src/components/shared/events.ts`).
Это обеспечивает слабую связанность между слоями MVP.

### Основные события

- `checkout:start` — начало оформления заказа.
- `checkout:next` — переход к следующему шагу.
- `checkout:email:set` — установка email.
- `checkout:phone:set` — установка телефона.
- `checkout:payment:set` — установка способа оплаты.
- `checkout:address:set` — установка адреса доставки.
- `cart:add` — добавление товара в корзину.
- `cart:delete` — удаление товара из корзины.
- `cart:update` — обновление корзины.
- `quote:update` — обновление промежуточных данных заказа.
- `quote:clear` — очистка данных заказа.
- `product:view` — просмотр детальной информации о товаре.

--- 